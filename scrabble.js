!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);let n={reverse:function(t){for(var e="",i=t.length-1;i>=0;--i)e+=t.charAt(i);return e},difference:function(t,e){for(var i=t.split(""),n=e.split(""),r=0;r<n.length;++r)for(var o=0;o<i.length;++o)if(n[r]==i[o]){i[o]="";break}return i.join("")},shuffle:function(t){for(var e=t.length-1;e>0;--e){var i=Math.round(Math.random()*e),n=t[e];t[e]=t[i],t[i]=n}return t},bindFn:function(t,e){return t.bind(e)},bind:function(t,e,i){window.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)},unbind:function(t,e,i){window.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent("on"+e,i)},rebind:function(t,e,i){n.unbind(t,e,i),n.bind(t,e,i)},removeAllChildren:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},getDocumentCoords:function(t){for(var e=t,i=0,n=0;e;)i+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{x:i,y:n}}};var r=n;let o=function(){this.bag_=[],this.init_()};o.singleton_=null,o.getSingleton=function(){return o.singleton_||(o.singleton_=new o),o.singleton_},o.prototype.init_=function(){var t={A:9,B:2,C:2,D:4,E:12,F:2,G:3,H:2,I:9,J:1,K:1,L:4,M:2,N:6,O:8,P:2,Q:1,R:6,S:4,T:6,U:4,V:2,W:2,X:1,Y:2,Z:1};for(var e in t)if(t.hasOwnProperty(e))for(var i=0;i<t[e];++i)this.bag_.push(e);r.shuffle(this.bag_)},o.prototype.pick=function(t){for(var e=[],i=this.bag_,n=i.length>t?t:i.length,r=0;r<n;++r){var o=Math.round(Math.random()*(i.length-1));e.push(i[o]),i[o]=i[i.length-1],i.length--}return e.join("")},o.prototype.tilesRemaining=function(){return this.bag_.length};var s=o;let a=function(){this.stats_={}};a.singleton_=null,a.getSingleton=function(){return a.singleton_||(a.singleton_=new a),a.singleton_},a.prototype.incTime=function(t,e){this.incVar_("time_"+t,e)},a.prototype.incCount=function(t,e){this.incVar_("count_"+t,e||1)},a.prototype.allStatsToString=function(){return this.timeStatsToString()+"\n"+this.countStatsToString()},a.prototype.timeStatsToString=function(){return this.statsWithPrefixToStr_("time_")},a.prototype.countStatsToString=function(){return this.statsWithPrefixToStr_("count_")},a.prototype.statsWithPrefixToStr_=function(t){var e=[];for(var i in this.stats_)this.stats_.hasOwnProperty(i)&&i.substring(0,t.length)==t&&("time_"==t?e.push(i.substring(t.length)+": "+this.stats_[i]/1e3+" seconds"):e.push(i.substring(t.length)+": "+this.stats_[i]));return e.join("\n")},a.prototype.incVar_=function(t,e){void 0===this.stats_[t]&&(this.stats_[t]=0),this.stats_[t]+=e};var l=a;let h=function(){this.trie_={}};h.WORD_FOUND=1,h.WORD_NOT_FOUND=2,h.prototype.add=function(t){t=t.toUpperCase();for(var e=this.trie_,i=0;i<t.length;++i){var n=t.charAt(i);e[n]||(e[n]={}),e=e[n]}e["#"]=!0},h.prototype.lookup=function(t){for(var e=(new Date).getTime(),i=this.trie_,n=0;n<t.length;++n){var r=t.charAt(n);if(!i[r])return{longestValidPrefix:t.substring(0,n),status:h.WORD_NOT_FOUND,word:t};i=i[r]}var o=(new Date).getTime();return l.getSingleton().incTime("trieLookup",o-e),i["#"]?{status:h.WORD_FOUND,word:t}:{status:h.WORD_NOT_FOUND,word:t}},h.prototype.print=function(t){this.printImpl_(this.trie_,"",t)},h.prototype.printImpl_=function(t,e,i){if(t["#"]&&window.console.log(e),!(e.length>=i))for(var n in t)t.hasOwnProperty(n)&&this.printImpl_(t[n],e+n,i)},h.prototype.countChars=function(){return this.countCharsImpl_(this.trie_)},h.prototype.countCharsImpl_=function(t){var e=0;for(var i in t)t.hasOwnProperty(i)&&(e++,e+=this.countCharsImpl_(t[i]));return e};var d=h;let u=function(t){this.board_=[],this.dictionary_=t};u.LETTER_SCORE={A:1,B:3,C:3,D:2,E:1,F:4,G:2,H:4,I:1,J:8,K:5,L:1,M:3,N:1,O:1,P:3,Q:10,R:1,S:1,T:1,U:1,V:4,W:4,X:8,Y:4,Z:10,1:0,2:0,3:0,4:0},u.CENTER_TILE_INDEX=144,u.prototype.parseFromString=function(t){for(var e=0,i=0;e<t.length;++e)" "!=t.charAt(e)&&(this.board_[i++]=t.charAt(e),"."!=t.charAt(e)&&"*"!=t.charAt(e)||(this.board_[i-1]=null))},u.prototype.printBoardToStr=function(){for(var t="",e=1;e<16;++e){for(var i=0;i<16;++i){var n=17*e+i;this.board_[n]?t+=this.board_[n]+" ":t+=". "}t+="\n"}return t},u.prototype.printBoardToHTML=function(){var t=document.getElementById("board");r.removeAllChildren(t);for(var e=1;e<16;++e)for(var i=1;i<16;++i){var n=17*e+i,o=document.createElement("div"),s="tile";this.isLetter(n)&&(o.innerHTML=this.getTileHTML(this.board_[n]),s+=" letter");var a=this.board_[n],l="",h=!1;if("4"==a?(h=!0,l="TW",s+=" tw"):"3"==a?(h=!0,l="DW",s+=" dw",144==n&&(s+=" center-square")):"2"==a?(h=!0,l="TL",s+=" tl"):"1"==a&&(h=!0,l="DL",s+=" dl"),h){var d=document.createElement("div");d.innerHTML=l,d.className="special-square",o.appendChild(d)}o.className=s,o.style.top=40*(e-1),o.style.left=40*(i-1),t.appendChild(o)}},u.prototype.charAt=function(t){return void 0!==this.board_[t]?this.board_[t]:""},u.prototype.isLetter=function(t){return this.board_[t]>="A"&&this.board_[t]<="Z"},u.prototype.computePrefix=function(t,e){for(var i="",n=e?1:17,o=t-n;this.isLetter(o);)i+=this.board_[o],o-=n;return r.reverse(i)},u.prototype.updateScoreAndMultiplier=function(t,e,i){var n=(new Date).getTime(),r=u.LETTER_SCORE[t];i.score+=r;var o=this.board_[e];"4"==o?i.scoreMultiplier*=3:"3"==o?i.scoreMultiplier*=2:"2"==o?i.score+=2*r:"1"==o&&(i.score+=r);var s=(new Date).getTime();l.getSingleton().incTime("updateScoreAndMultiplier",s-n)},u.prototype.makeMove=function(t,e,i){for(var n=[],r=e?1:17,o=0,s=t;o<i.length;++o,s+=r){for(;this.isLetter(s);)s+=r;this.board_[s]=i.charAt(o),n.push(s)}return n},u.prototype.computeScore=function(t,e,i){for(var n=i?1:17,o=0,s={score:0,scoreMultiplier:1,word:""},a=(new Date).getTime(),h=t-n;this.isLetter(h);){var c=this.board_[h],m=u.LETTER_SCORE[c];s.score+=m,s.word+=c,h-=n}s.word=r.reverse(s.word);var f=(new Date).getTime();l.getSingleton().incTime("defaultDirPrefix",f-a);for(var p=0,_=t;p<e.length;)this.isLetter(_)?(c=this.board_[_],m=u.LETTER_SCORE[c],s.score+=m):(c=e.charAt(p),this.updateScoreAndMultiplier(e.charAt(p),_,s),++p),s.word+=c,_+=n;for(;this.isLetter(_);){c=this.board_[_],m=u.LETTER_SCORE[c];s.score+=m,s.word+=c,_+=n}if(o+=s.score*s.scoreMultiplier,this.dictionary_.lookup(s.word).status!=d.WORD_FOUND)return f=(new Date).getTime(),l.getSingleton().incTime("defaultDirFail",f-a),-1;for(f=(new Date).getTime(),l.getSingleton().incTime("defaultDirSuccess",f-a),a=(new Date).getTime(),p=0,_=t;p<e.length;)if(this.isLetter(_))_+=n;else if(this.isLetter(_-(18-n))||this.isLetter(_+(18-n))){for(s={score:0,scoreMultiplier:1,word:""},h=_-(18-n);this.isLetter(h);){c=this.board_[h],m=u.LETTER_SCORE[c];s.score+=m,s.word+=c,h-=18-n}s.word=r.reverse(s.word),c=e.charAt(p),this.updateScoreAndMultiplier(e.charAt(p),_,s),s.word+=c;for(var g=_+(18-n);this.isLetter(g);){c=this.board_[g],m=u.LETTER_SCORE[c];s.score+=m,s.word+=c,g+=18-n}if(o+=s.score*s.scoreMultiplier,this.dictionary_.lookup(s.word).status!=d.WORD_FOUND)return f=(new Date).getTime(),l.getSingleton().incTime("oppositeDir",f-a),-1;_+=n,++p}else _+=n,++p;return f=(new Date).getTime(),l.getSingleton().incTime("oppositeDir",f-a),o},u.prototype.getTileCoords=function(t){var e=document.getElementById("board"),i=r.getDocumentCoords(e),n=Math.floor(t/17),o=t%17;return{x:i.x+40*(o-1),y:i.y+40*(n-1)}},u.prototype.getSnapToGridTileIndex=function(t){var e=document.getElementById("board"),i=r.getDocumentCoords(e),n=r.getDocumentCoords(t);return n.x+40<=i.x||n.x>=i.x+600||n.y+40<=i.y||n.y>=i.y+600?{success:!1,index:-1}:{success:!0,x:i.x+40*Math.round((n.x-i.x)/40),y:i.y+40*Math.round((n.y-i.y)/40),index:17*(Math.round((n.y-i.y)/40)+1)+Math.round((n.x-i.x)/40)+1}},u.prototype.getTileHTML=function(t){return'<div style="margin-top:5px; margin-left:4px;"><span>'+t+'</span><span style="color:#ffffff;font-size:0.6em;vertical-align:sub;">'+u.LETTER_SCORE[t]+"</span></div>"};var c=u;let m=function(t,e){this.board_=t,this.dictionary_=e,this.tiles_="",this.scoreSoFar_=0};m.prototype.removeTilesAndRefreshFromBag=function(t){this.tiles_=r.difference(this.tiles_,t),this.tiles_+=s.getSingleton().pick(7-this.tiles_.length)},m.prototype.calculateWordLengthBounds_=function(t){var e=0,i=0;this.board_.isLetter(t-1)&&(e=1);for(var n=t,r=0;n<17*(Math.floor(t/17)+1)-1;++n)if(0==e&&(this.board_.isLetter(n-17)||this.board_.isLetter(n+17)||this.board_.isLetter(n+1)))i=e=++r;else if(!this.board_.isLetter(n)&&(++i,++r==this.tiles_.length))break;0==e&&(i=0);var o=0,s=0;this.board_.isLetter(t-17)&&(o=1);for(n=t,r=0;n<272;n+=17)if(0==o&&(this.board_.isLetter(n-1)||this.board_.isLetter(n+1)||this.board_.isLetter(n+17)))s=o=++r;else if(!this.board_.isLetter(n)&&(++s,++r==this.tiles_.length))break;return 0==o&&(s=0),{minLengthHorizontal:e,maxLengthHorizontal:i,minLengthVertical:o,maxLengthVertical:s}},m.prototype.allPossiblePermuationsToConsider_=function(t,e,i){let n=new d;for(var r=this.powerSet_(t,e,i),o=0;o<r.length;++o)for(var s=this.permutations_(r[o]),a=0;a<s.length;++a)n.add(s[a]);return n},m.prototype.powerSet_=function(t,e,i){var n=[];return this.powerSetImpl_(n,"","",t,0,e,i),n},m.prototype.powerSetImpl_=function(t,e,i,n,r,o,s){if(r!=n.length){for(var a=n.charAt(r),l=0,h=!1;l<r;++l)if(a==n.charAt(l)){h=!0;var d="1"==i.charAt(l)}this.powerSetImpl_(t,e,i+"0",n,r+1,o,s),h?d&&this.powerSetImpl_(t,e+a,i+"1",n,r+1,o,s):this.powerSetImpl_(t,e+a,i+"1",n,r+1,o,s)}else e.length>=o&&e.length<=s&&t.push(e)},m.prototype.permutations_=function(t){var e=[];return this.permutationsImpl_(e,"",t),e},m.prototype.permutationsImpl_=function(t,e,i){if(0!=i.length)for(var n=0;n<i.length;++n){for(var r=0,o=!1;r<n;++r)if(i.charAt(n)==i.charAt(r)){o=!0;break}if(!o){var s="";for(r=0;r<i.length;++r)n!=r&&(s+=i.charAt(r));this.permutationsImpl_(t,e+i.charAt(n),s)}}else t.push(e)},m.prototype.computeBestMove=function(){for(var t={horizontal:!1,index:-1,score:-1,tiles:"",word:""},e=this.allPossiblePermuationsToConsider_(this.tiles_,1,7),i=1;i<16;++i)for(var n=1;n<16;++n){var r=17*i+n;if(!this.board_.isLetter(r)){var o=this.calculateWordLengthBounds_(r);if(0!=o.minLengthHorizontal||0!=o.maxLengthHorizontal||0!=o.minLengthVertical||0!=o.maxLengthVertical){var s=this.computeBestScoreAt_(e,r,o);s.score>t.score&&(t.horizontal=s.horizontal,t.index=r,t.score=s.score,t.tiles=s.tiles,t.word=s.word)}}}return this.scoreSoFar_+=t.score,t},m.prototype.computeBestScoreAt_=function(t,e,i){var n={horizontal:!0,score:-1,tiles:"",word:""},r={horizontal:!1,score:-1,tiles:"",word:""},o=i.minLengthHorizontal,s=i.maxLengthHorizontal,a=this.board_.computePrefix(e,!0);return this.computeBestScoreAtImpl_(t.trie_,"",e,!0,a,n,0,o,s),o=i.minLengthVertical,s=i.maxLengthVertical,a=this.board_.computePrefix(e,!1),this.computeBestScoreAtImpl_(t.trie_,"",e,!1,a,r,0,o,s),n.score>=r.score?n:r},m.prototype.computeBestScoreAtImpl_=function(t,e,i,n,r,o,s,a,l){for(var h in t)if(t.hasOwnProperty(h)){if(s>=a&&"#"==h){var u=this.tryStrAt_(i,n,r,e);if(u.status==d.WORD_NOT_FOUND){if(u.longestValidPrefix&&u.longestValidPrefix.length-r.length<s-1)return u}else{var c=this.board_.computeScore(i,e,n);c>0&&7==e.length&&(c+=50),c>o.score&&(o.score=c,o.tiles=e,o.word=u.word)}if(s>l)return u;continue}if(s<l&&(u=this.computeBestScoreAtImpl_(t[h],e+h,i,n,r,o,s+1,a,l))&&u.status==d.WORD_NOT_FOUND&&u.longestValidPrefix&&u.longestValidPrefix.length-r.length<s)return u}},m.prototype.tryStrAt_=function(t,e,i,n){for(var r=e?1:17,o=i,s=0,a=t;s<n.length;++s,a+=r){for(;this.board_.isLetter(a);)o+=this.board_.charAt(a),a+=r;o+=n.charAt(s)}for(;this.board_.isLetter(a);)o+=this.board_.charAt(a),a+=r;return this.dictionary_.lookup(o)};var f=m;let p=function(){this.dictionary_=new d,this.board_=new c(this.dictionary_),this.board_.parseFromString(this.initBoard_()),this.board_.printBoardToHTML(),this.human_=null,this.aiPlayers_=[],this.moveNumber_=0,this.elementBeingDragged_=null,this.elementOffsetX_=0,this.elementOffsetY_=0,this.animatedTiles_=[];var t=document.getElementById("humanPlayButton");r.bind(t,"click",this.humanMove_.bind(this)),(t=document.getElementById("humanRecallButton")).disabled=!0,r.bind(t,"click",this.humanRecall_.bind(this)),(t=document.getElementById("humanShuffleButton")).disabled=!0,r.bind(t,"click",this.humanShuffle_.bind(this)),t=document.getElementById("dictionaryButton"),r.bind(t,"click",this.checkDictionary_.bind(this)),r.bind(document,"mousemove",this.dragHandler_.bind(this)),r.bind(document,"selectstart",function(t){t.preventDefault()})};p.singleton_=null,p.getSingleton=function(){return p.singleton_||(p.singleton_=new p),p.singleton_},p.readDictionary=function(t){p.getSingleton().readDictionary_(t)},p.play=function(){p.getSingleton().play_()},p.prototype.play_=function(){this.initGame_(),this.human_.name=window.prompt("Type in your name:")||"HUMAN",this.human_.name=this.human_.name.toUpperCase(),document.getElementById("scoreHuman").innerHTML=this.human_.name,document.body.style.display=""},p.prototype.dragHandler_=function(t){var e=this.elementBeingDragged_;e&&(e.style.position="fixed",e.style.zIndex=10,e.style.left=t.clientX-this.elementOffsetX_,e.style.top=t.clientY-this.elementOffsetY_)},p.prototype.initGame_=function(){this.human_={name:"HUMAN",tiles:s.getSingleton().pick(7),tilesBeingMoved:[],scoreSoFar:0},this.printTilesAndMaybeSetEventHandlers_(this.human_.tiles,!1);let t=new f(this.board_,this.dictionary_);this.aiPlayers_.push(t),t.removeTilesAndRefreshFromBag(""),this.printTilesAndMaybeSetEventHandlers_(t.tiles_,!0),document.getElementById("humanPlayButton").disabled=!1,document.getElementById("humanShuffleButton").disabled=!1,document.getElementById("tilesRemaining").innerHTML="Tiles remaining: "+s.getSingleton().tilesRemaining()},p.prototype.controller_=function(){document.getElementById("tilesRemaining").innerHTML="Tiles remaining: "+s.getSingleton().tilesRemaining(),document.getElementById("humanPlayButton").disabled=!0,document.getElementById("humanRecallButton").disabled=!0,document.getElementById("humanShuffleButton").disabled=!0,""!=this.human_.tiles?this.aiMove_(this.aiPlayers_[0]):this.displayEndOfGameMessage_(!0)},p.prototype.humanMove_=function(){var t=this.human_.tilesBeingMoved;if(0==this.moveNumber_){for(var e=0,i=!1;e<t.length;++e)t[e]&&t[e].index==c.CENTER_TILE_INDEX&&(i=!0);if(!i)return void alert("The first move must pass through the center square. Try again.")}var n=null,o=0,a=!1,l=!1,h={};for(e=0;e<t.length;++e)if(t[e])if(o++,n){if(h[t[e].x+":"+t[e].y])return void alert("You have placed a tile on top of another! Try again.");if(t[e].x==n.x)l=!0;else{if(t[e].y!=n.y)return void alert("All tiles must be in a line! Try again.");a=!0}}else h[(n={x:t[e].x,y:t[e].y}).x+":"+n.y]=!0;if(0!=o){if(1==o)t.sort();else{if(a&&l)return void alert("All tiles must be in one line! Try again.");a?t.sort(function(t,e){return t.x-e.x}):l&&t.sort(function(t,e){return t.y-e.y})}var d,u="";for(e=0;e<t.length;++e)t[e]&&(u+=t[e].tileChar);u.length>1?d=this.board_.computeScore(t[0].index,u,a):-1==(d=this.board_.computeScore(t[0].index,u,!0))&&(d=this.board_.computeScore(t[0].index,u,!1)),-1!=d?(this.board_.makeMove(t[0].index,a,u),this.board_.printBoardToHTML(),this.human_.tiles=r.difference(this.human_.tiles,u),this.human_.tiles+=s.getSingleton().pick(7-this.human_.tiles.length),this.human_.tilesBeingMoved=[],this.printTilesAndMaybeSetEventHandlers_(this.human_.tiles,!1),this.human_.scoreSoFar+=d,this.animateScoreCounter_(d,"scoreHuman",this.human_.name),this.moveNumber_++,this.controller_()):alert("Invalid word! Try again.")}else alert('You need to drag one or more tiles and drop them on the board. Then click "Play!"')},p.prototype.humanRecall_=function(){this.board_.printBoardToHTML(),this.human_.tilesBeingMoved=[],this.printTilesAndMaybeSetEventHandlers_(this.human_.tiles,!1),document.getElementById("humanRecallButton").disabled=!0},p.prototype.humanShuffle_=function(){this.human_.tiles=r.shuffle(this.human_.tiles.split("")).join(""),this.board_.printBoardToHTML(),this.human_.tilesBeingMoved=[],this.printTilesAndMaybeSetEventHandlers_(this.human_.tiles,!1)},p.prototype.checkDictionary_=function(){var t=window.prompt("Check if a word is in the dictionary:");this.dictionary_.lookup(t.toUpperCase()).status==d.WORD_FOUND?alert('"'+t+'" is a dictionary word.'):alert('"'+t+'" is NOT a dictionary word!')},p.prototype.aiMove_=function(t){var e=t.computeBestMove();window.console&&window.console.log(e);for(var i=this.board_.makeMove(e.index,e.horizontal,e.tiles),n=[],o=r.getDocumentCoords(document.getElementById("tilesAI")),s=this.aiPlayers_[0].tiles_,a=[],l=0;l<e.tiles.length;++l)for(var h=0;h<s.length;++h)if(e.tiles[l]==s[h]&&!a[h]){n.push([o.x+40*h+10,o.y+10,h]),a[h]=!0;break}var d=[];for(l=0;l<i.length;++l)d.push(this.board_.getTileCoords(i[l]));this.animateAIMove_(n,d,e.tiles,t),this.animateScoreCounter_(e.score,"scoreAI","MACHINE"),this.moveNumber_++},p.prototype.animateAIMove_=function(t,e,i,n){for(var o=t.length,a=0,l=[],h=[],d=0;d<i.length;++d){var u=t[d][0],c=e[d].x,m=t[d][1],f=e[d].y,p=Math.abs(c-u),_=Math.abs(f-m);p>=_?l.push([p/_*(c>=u?2:-2),f>=m?2:-2]):l.push([c>=u?2:-2,_/p*(f>=m?2:-2)]),h.push([t[d][0],t[d][1]]);var g=document.createElement("div");g.className="tile letter letter-ai",g.innerHTML=this.board_.getTileHTML(i.charAt(d)),g.style.visibility="hidden",g.style.position="fixed",document.body.appendChild(g),this.animatedTiles_.push(g)}document.getElementById("tilesAI").childNodes[t[0][2]].style.visibility="hidden";var y=r.bindFn(function(){var r=this.animatedTiles_[a].style;if(r.visibility="visible",r.left=Math.round(h[a][0]),r.top=Math.round(h[a][1]),h[a][0]+=l[a][0],h[a][1]+=l[a][1],e[a].x>=t[a][0]&&h[a][0]>=e[a].x||e[a].x<t[a][0]&&h[a][0]<=e[a].x||e[a].y>=t[a][1]&&h[a][1]>=e[a].y||e[a].y<t[a][1]&&h[a][1]<=e[a].y)if(r.left=e[a].x,r.top=e[a].y,++a==o){if(n.removeTilesAndRefreshFromBag(i),this.printTilesAndMaybeSetEventHandlers_(n.tiles_,!0),window.clearInterval(v),document.getElementById("tilesRemaining").innerHTML="Tiles remaining: "+s.getSingleton().tilesRemaining(),""==this.aiPlayers_[0].tiles_)return void this.displayEndOfGameMessage_(!1);document.getElementById("humanPlayButton").disabled=!1,document.getElementById("humanShuffleButton").disabled=!1}else{document.getElementById("tilesAI").childNodes[t[a][2]].style.visibility="hidden"}},this),v=window.setInterval(y,10)},p.prototype.garbageCollectAnimatedTiles_=function(){for(var t=0;t<this.animatedTiles_.length;++t)this.animatedTiles_[t].parentNode.removeChild(this.animatedTiles_[t]);this.animatedTiles_=[],this.board_.printBoardToHTML()},p.prototype.printTilesAndMaybeSetEventHandlers_=function(t,e){var i=document.getElementById(e?"tilesAI":"tilesHuman");r.removeAllChildren(i);for(var n=0;n<t.length;++n){var o=document.createElement("div");o.className="tile letter",e||(o.innerHTML=this.board_.getTileHTML(t.charAt(n))),o.style.left=40*n+10,o.style.top=10,i.appendChild(o),e||(r.bind(o,"mousedown",function(t,e){return r.bindFn(function(t){this.garbageCollectAnimatedTiles_(),this.elementBeingDragged_=e;var i=r.getDocumentCoords(e);this.elementOffsetX_=t.clientX-i.x,this.elementOffsetY_=t.clientY-i.y},t)}(this,o)),r.bind(o,"mouseup",function(t,e,i){return r.bindFn(function(t){var n=this.elementBeingDragged_,r=this.board_.getSnapToGridTileIndex(n);r.success?(n.style.left=r.x,n.style.top=r.y,this.human_.tilesBeingMoved[e]={x:r.x,y:r.y,index:r.index,tileChar:i}):this.human_.tilesBeingMoved[e]=void 0,n.style.zIndex=0,this.elementBeingDragged_=null,document.getElementById("humanRecallButton").disabled=!1},t)}(this,n,t.charAt(n))),r.bind(o,"mouseover",function(t){return function(e){t.className="tile letter letter-hover"}}(o)),r.bind(o,"mouseout",function(t){return function(e){t.className="tile letter"}}(o)),r.bind(o,"touchstart",function(t,e){return r.bindFn(function(t){this.garbageCollectAnimatedTiles_(),e.className="tile letter letter-hover"},t)}(this,o)),r.bind(o,"touchend",function(t,e,i){return r.bindFn(function(t){var n=t.changedTouches[0].target,r=this.board_.getSnapToGridTileIndex(n);r.success?(n.style.left=r.x,n.style.top=r.y,this.human_.tilesBeingMoved[e]={x:r.x,y:r.y,index:r.index,tileChar:i}):this.human_.tilesBeingMoved[e]=void 0,n.style.zIndex=0,n.className="tile letter",document.getElementById("humanRecallButton").disabled=!1},t)}(this,n,t.charAt(n))),r.bind(o,"touchmove",function(t){return function(e){if(1==e.touches.length){var i=e.touches[0];t.style.position="fixed",t.style.zIndex=10,t.style.left=i.clientX,t.style.top=i.clientY}}}(o)))}},p.prototype.animateScoreCounter_=function(t,e,i){var n=function(){var n=document.getElementById(e).innerHTML;if(2==(n=n.split(":")).length)var o=Number(n[1]);else o=0;var s=o;return t<0&&(t=0),function(){document.getElementById(e).innerHTML=i+": "+s,s>=o+t&&window.clearInterval(r),++s}}(),r=window.setInterval(n,100)},p.prototype.displayEndOfGameMessage_=function(t){this.human_.scoreSoFar>this.aiPlayers_[0].scoreSoFar_?alert("You win!"):this.human_.scoreSoFar<this.aiPlayers_[0].scoreSoFar_?alert("Machine wins!"):alert("Game ends in a draw!")},p.prototype.readDictionary_=function(t){for(var e=(new Date).getTime(),i=0;i<t.length;++i)this.dictionary_.add(t[i]);var n=(new Date).getTime();l.getSingleton().incTime("trieInit",n-e)},p.prototype.initBoard_=function(){return"# # # # # # # # # # # # # # # # ## 4 . . 1 . . . 4 . . . 1 . . 4 ## . 3 . . . 2 . . . 2 . . . 3 . ## . . 3 . . . 1 . 1 . . . 3 . . ## 1 . . 3 . . . 1 . . . 3 . . 1 ## . . . . 3 . . . . . 3 . . . . ## . 2 . . . 2 . . . 2 . . . 2 . ## . . 1 . . . 1 . 1 . . . 1 . . ## 4 . . 1 . . . 3 . . . 1 . . 4 ## . . 1 . . . 1 . 1 . . . 1 . . ## . 2 . . . 2 . . . 2 . . . 2 . ## . . . . 3 . . . . . 3 . . . . ## 1 . . 3 . . . 1 . . . 3 . . 1 ## . . 3 . . . 1 . 1 . . . 3 . . ## . 3 . . . 2 . . . 2 . . . 3 . ## 4 . . 1 . . . 4 . . . 1 . . 4 ## # # # # # # # # # # # # # # # #"},window.game=p}]);